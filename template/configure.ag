dnl Process this file with autoconf to produce a configure script.
AC_INIT(src/example.mx)
AC_CONFIG_AUX_DIR(conf)

dnl ----------------------
AM_INIT_AUTOMAKE("template", 0.1)
AM_CONFIG_HEADER(template_config.h:conf/config.h.in)
AC_CANONICAL_HOST

HOST=[$host]
AC_DEFINE_UNQUOTED(HOST, "$HOST", [Host identifier])

dnl check for compiler
AC_ARG_WITH(gcc,
[  --with-gcc=<compiler>   which C compiler to use
  --without-gcc           do not use GCC], [
	case $withval in
	no)	CC=cc CXX=CC;;
	yes)	CC=gcc CXX=g++;;
	*)	CC=$withval;;
	esac])

AC_ARG_WITH(gxx,
[  --with-gxx=<compiler>   which C++ compiler to use], [
	case $withval in
	yes|no)	AC_ERROR(must supply a compiler when using --with-gxx);;
	*)	CXX=$withval;;
	esac])

AC_PROG_CC
AC_PROG_CXX
AC_PROG_CPP
AC_PROG_GCC_TRADITIONAL

dnl some dirty hacks
thread_safe_flag_spec="-D_REENTRANT"
[ case "$host_os" in
  solaris*)
    case "$CC" in
      cc*) 
	echo "$CC=cc"
        thread_safe_flag_spec="-mt" ;;
      *) ;;
    esac
    LEXLIB=-ll
    ;;
  irix*)
    LEXLIB=-ll
    ;;
  aix*)
    thread_safe_flag_spec="-D_THREAD_SAFE $thread_safe_flag_spec"
    ;;
esac ]

dnl Checks for programs.
AC_PROG_INSTALL
AM_PROG_LEX
AC_PROG_YACC
AC_DISABLE_STATIC
AC_ENABLE_SHARED
AM_PROG_LIBTOOL
dnl AC_PROG_CC_STDC

AC_PROG_LN_S
AC_CHECK_PROG(RM,rm,rm -f)
AC_CHECK_PROG(MV,mv,mv -f)
AC_CHECK_PROG(LOCKFILE,lockfile,lockfile -r 2,echo)

dnl to shut up automake (.m files are used for mel not for objc)
AC_CHECK_TOOL(OBJC,objc)

#AM_DEPENDENCIES(CC)
#AM_DEPENDENCIES(CXX)

dnl Checks for header files.
AC_HEADER_STDC

AM_MONET
AM_MONET_OPTIONS

dnl Checks for library functions.
AC_SUBST(thread_safe_flag_spec)
AC_SUBST(CFLAGS)
AC_SUBST(CXXFLAGS)

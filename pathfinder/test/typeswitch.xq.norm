xquery (prolog (nil (), nil ()),
  exprseq
    (typeswitch
       (locpath (step (child, namet (foo)), root ()),
       cases
         (case (seq_ty (1, node_ty (element, nil ())),
            nil (), lit_str ("element")), nil ()),
       varref ($#pf:tsw_000),
       typeswitch (varref ($#pf:tsw_000),
         cases
           (case
              (seq_ty (1,
                 node_ty (element,
                   req_ty (nil (), named_ty (foo)))),
              nil (), lit_str ("elem of type foo")),
           nil ()), varref ($#pf:tsw_001),
         typeswitch (varref ($#pf:tsw_001),
           cases
             (case
                (seq_ty (1,
                   node_ty (element,
                     req_ty (req_name (foo), nil ()))),
                nil (), lit_str ("elem foo")), nil ()),
           varref ($#pf:tsw_002),
           typeswitch (varref ($#pf:tsw_002),
             cases
               (case
                  (seq_ty (1,
                     node_ty (element,
                       req_ty (req_name (foo),
                         named_ty (bar)))), nil (),
                  lit_str ("elem foo of type bar")),
               nil ()), varref ($#pf:tsw_003),
             typeswitch (varref ($#pf:tsw_003),
               cases
                 (case
                    (seq_ty (1,
                       node_ty (element,
                         req_ty (req_name (foo),
                           schm_path
                             (glob_schm (schema-context),
                             nil ())))), nil (),
                    lit_str ("elem foo in context")),
                 nil ()), nil (), lit_str ("default")))))),
    empty-seq ()))
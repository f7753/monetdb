stdout of test 'tst_priv` in directory 'tests/by_Peter` itself:

#> Mtest (20:55:13):	milM tst_priv milM
#> Mtest (20:55:13):	Mtimeout -timeout 600 Mserver -modulesilent -yaccsilent -d8 -db tests_by_Peter tst_priv.milM
# Monet Database Server V4.2
# Copyright (c) 1993-1999, CWI & SION. All rights reserved.
# compiled for i686-pc-linux-gnu/32bit.
#script:tst_priv.milM

loaded;
#---------------------------------#
# module	| usage_count	  #
#---------------------------------#
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "kernel",	  1		  ]
[ "str",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]

Try: modules;                - for other modules.
     ls;                     - for persistent bat listing.
     sigs("<module>")        - for available commands per module.
     help("<command>")       - for help one-liner for a command.

#You are system administrator (adm)!
# test change of private mmap -> malloced under extends
new(void,str,1000000).persists(true).access(BAT_WRITE).rename("a");
d := new(void,int,1000);
i := 0;
while(i < 1000) d.insert(nil,i :+= 1);
d := [str](d).seqbase(0@0);
a.seqbase(0@0).insert(d);

i := 0;
while(i < 100) {
    a.insert(d);
    i :+= 1;
}

a.mmap(1,1,1,1,1);
unload("a");
a.info.reverse.select("theap.storage").reverse.print;
#-----------------------------------------#
# BAT:			  tmp_30	  #
# (str)			  (str)		  #
#-----------------------------------------#
[ "theap.storage",	  "malloced"	  ]

[int](a.mirror);
e := [str]([int](a.mirror));
debugmask(49);
a.insert(e);
#01 interpret_pin(insert) on bat(24) refcnt = 2
#01 interpret_pin(insert) => 24[1,0]
#01 interpret_pin(insert) on bat(31) refcnt = 2
#01 interpret_pin(insert) => 31[1,0]
# batstamp(24) = 0
#01 interpret_unpin(insert) on bat(24) refcnt = 2
#01 interpret_unpin(insert) => kill 24[0,1]
#01 interpret_unpin(insert) on bat(31) refcnt = 1
#01 interpret_unpin(insert) => kill 31[0,1]
debugmask(9);

#a.mmap(1,1,1,1,1);
a.info.reverse.select("theap.storage").reverse.print;
#-----------------------------------------#
# BAT:			  tmp_23	  #
# (str)			  (str)		  #
#-----------------------------------------#
[ "theap.storage",	  "malloced"	  ]
e := [str]([int](a.mirror));
debugmask(49);
a.insert(e);
#01 interpret_pin(insert) on bat(24) refcnt = 2
#01 interpret_pin(insert) => 24[1,0]
#01 interpret_pin(insert) on bat(32) refcnt = 2
#01 interpret_pin(insert) => 32[1,0]
# batstamp(24) = 0
#01 interpret_unpin(insert) on bat(24) refcnt = 2
#01 interpret_unpin(insert) => kill 24[0,1]
#01 interpret_unpin(insert) on bat(32) refcnt = 1
#01 interpret_unpin(insert) => kill 32[0,1]
debugmask(9);

a.info.reverse.select("theap.storage").reverse.print;
#-----------------------------------------#
# BAT:			  tmp_30	  #
# (str)			  (str)		  #
#-----------------------------------------#
[ "theap.storage",	  "malloced"	  ]
a.insert(nil,"make dirty..");
commit;
#01 #BBPdir: writing BBP.dir (48 bats).

a.destroy;
commit;
#01 #BBPdir: writing BBP.dir (48 bats).

quit;

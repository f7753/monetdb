stdout of test 'test_60` in directory 'tests/suite_00` itself:

#> Mtest:	milS test_60 milS
#> Mtest:	Mtimeout -timeout 210 Mserver -modulesilent -yaccsilent -d8 -db tests_suite_00 -single test_60.milS
# Monet Database Server V4.1
# Copyright (c) 1993-1999, CWI & SION. All rights reserved.
# compiled for IRIX646.5/32bit on Fri Jan 14 01:04:33 MET 2000.
#script:test_60.milS

loaded;
#---------------------------------#
# module	| usage_count	  #
#---------------------------------#
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "kernel",	  1		  ]
[ "str",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]

Try: modules;                - for other modules.
     ls;                     - for persistent bat listing.
     sigs("<module>")        - for available commands per module.
     help("<command>")       - for help one-liner for a command.

#You are system administrator (adm)!
setoid(oid(20000000));
# For distributed processing it should be possible
# split and re-distribute BATs.
# This is supported by hashsplit, rangesplit,  and groupby operations.

PROC groupby(b, rng) := {
 VAR r := rng.reverse.number.reverse;
 VAR l := rng.number.reverse;
 RETURN [select]([l~const b],l,r);
}


b:= new(int,int);
b.insert(1,15);
b.insert(2,4);
b.insert(3,int(nil));
b.insert(4,16);
b.insert(5,25);
b.insert(6,36);
b.insert(7,49);
b.insert(8,64);
b.insert(9,int(nil));
b.insert(int(nil),int(nil));
b.insert(int(nil),81);
b.rename("b");

rng:= new(int,int);
rng.insert(1,1);
rng.insert(1,9);
rng.insert(int(nil),9);
rng.insert(1,int(nil));
rng.insert(9,9);
rng.insert(3,5);

bb := b.groupby(rng);
bb.print;
#-------------------------#
# BAT:	  tmp_31	  #
# (int)	  (BAT)		  #
#-------------------------#
[ 0,	  <tmp_28>	  ]
[ 1,	  <tmp_30>	  ]
[ 2,	  <tmp_31>	  ]
[ 3,	  <tmp_32>	  ]
[ 4,	  <tmp_33>	  ]
[ 5,	  <tmp_34>	  ]
bb@batloop() $t.print;
#-----------------#
# BAT:	  tmp_30  #
# (int)	  (int)	  #
#-----------------#
#-----------------#
# BAT:	  tmp_32  #
# (int)	  (int)	  #
#-----------------#
[ 2,	  4	  ]
#-----------------#
# BAT:	  tmp_33  #
# (int)	  (int)	  #
#-----------------#
[ 2,	  4	  ]
#-----------------#
# BAT:	  tmp_34  #
# (int)	  (int)	  #
#-----------------#
[ 1,	  15	  ]
[ 2,	  4	  ]
[ 4,	  16	  ]
[ 5,	  25	  ]
[ 6,	  36	  ]
[ 7,	  49	  ]
[ 8,	  64	  ]
[ nil,	  81	  ]
#-----------------#
# BAT:	  tmp_35  #
# (int)	  (int)	  #
#-----------------#
#-----------------#
# BAT:	  tmp_36  #
# (int)	  (int)	  #
#-----------------#
[ 2,	  4	  ]

# other values;
x:= new(int,chr);
x.insert(1,'a');
x.insert(2,'a');
x.insert(3,'b');
x.insert(4,'b');
x.insert(5,'b');
x.insert(6,'b');
x.insert(7,'c');
x.insert(8,'c');

t := new(chr,chr);
t.insert('a','b');
t.insert('c','c');
t.insert('b','b');
xx:= x.groupby(t);
xx.print;
#-------------------------#
# BAT:	  tmp_40	  #
# (int)	  (BAT)		  #
#-------------------------#
[ 0,	  <tmp_37>	  ]
[ 1,	  <tmp_39>	  ]
[ 2,	  <tmp_40>	  ]
xx@batloop() $t.print;
#-----------------#
# BAT:	  tmp_39  #
# (int)	  (chr)	  #
#-----------------#
[ 1,	  'a'	  ]
[ 2,	  'a'	  ]
[ 3,	  'b'	  ]
[ 4,	  'b'	  ]
[ 5,	  'b'	  ]
[ 6,	  'b'	  ]
#-----------------#
# BAT:	  tmp_41  #
# (int)	  (chr)	  #
#-----------------#
[ 7,	  'c'	  ]
[ 8,	  'c'	  ]
#-----------------#
# BAT:	  tmp_42  #
# (int)	  (chr)	  #
#-----------------#
[ 3,	  'b'	  ]
[ 4,	  'b'	  ]
[ 5,	  'b'	  ]
[ 6,	  'b'	  ]

# other values;
x:= new(int,str);
x.insert(1,"a");
x.insert(2,"a");
x.insert(3,"b");
x.insert(4,"b");
x.insert(5,"b");
x.insert(6,"b");
x.insert(7,"c");
x.insert(8,"c");

t:= new(str,str);
t.rename("t");
t.insert("a","b");
t.insert("c","c");
t.insert("b","b");
xx:= x.groupby(t);
xx.print;
#-------------------------#
# BAT:	  tmp_44	  #
# (int)	  (BAT)		  #
#-------------------------#
[ 0,	  <tmp_41>	  ]
[ 1,	  <tmp_43>	  ]
[ 2,	  <tmp_44>	  ]
xx@batloop() $t.print;
#-----------------#
# BAT:	  tmp_43  #
# (int)	  (str)	  #
#-----------------#
[ 1,	  "a"	  ]
[ 2,	  "a"	  ]
[ 3,	  "b"	  ]
[ 4,	  "b"	  ]
[ 5,	  "b"	  ]
[ 6,	  "b"	  ]
#-----------------#
# BAT:	  tmp_45  #
# (int)	  (str)	  #
#-----------------#
[ 7,	  "c"	  ]
[ 8,	  "c"	  ]
#-----------------#
# BAT:	  tmp_46  #
# (int)	  (str)	  #
#-----------------#
[ 3,	  "b"	  ]
[ 4,	  "b"	  ]
[ 5,	  "b"	  ]
[ 6,	  "b"	  ]
quit;

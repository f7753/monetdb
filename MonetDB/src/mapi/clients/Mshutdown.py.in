#!/usr/bin/env python
import sys
import os

if os.environ.has_key('MONET_PREFIX'):
    sys.path.append(os.environ['MONET_PREFIX']+os.sep+'share'+os.sep+'MonetDB'+os.sep+'python')
else:
    sys.path.append('@prefix@'+os.sep+'share'+os.sep+'@PACKAGE@'+os.sep+'python')

import monet_options
import Mapi

cmd_options = [
    ('host',None,'host','hostname','host to connect to (default: localhost)'),
    ('port',None,'mapi_port','port','port to connect to (default: 50000)'),
    ]

try:
    opt, args = monet_options.parse_options(sys.argv[1:], cmd_options)
except monet_options.Error:
    # error parsing options
    sys.exit(1)

s = Mapi.server( opt.get("host","localhost"), int(opt.get("mapi_port",50000)), "adm" )

res = s.cmd_intern( "shutdown;\n" )
s.disconnect()

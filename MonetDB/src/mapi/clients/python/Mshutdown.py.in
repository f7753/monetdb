#!/usr/bin/env python

# The contents of this file are subject to the MonetDB Public
# License Version 1.0 (the "License"); you may not use this file
# except in compliance with the License. You may obtain a copy of
# the License at
# http://monetdb.cwi.nl/Legal/MonetDBLicense-1.0.html
# 
# Software distributed under the License is distributed on an "AS
# IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
# implied. See the License for the specific language governing
# rights and limitations under the License.
# 
# The Original Code is the Monet Database System.
# 
# The Initial Developer of the Original Code is CWI.
# Portions created by CWI are Copyright (C) 1997-2004 CWI.
# All Rights Reserved.
# 
# Contributor(s):
# 		Martin Kersten <Martin.Kersten@cwi.nl>
# 		Peter Boncz <Peter.Boncz@cwi.nl>
# 		Niels Nes <Niels.Nes@cwi.nl>
# 		Stefan Manegold  <Stefan.Manegold@cwi.nl>

import sys
import os

if os.environ.has_key('MONETDB_PREFIX'):
    sys.path.append(os.environ['MONETDB_PREFIX']+os.sep+'share'+os.sep+'MonetDB'+os.sep+'python')
else:
    sys.path.append('@Qprefix@'+os.sep+'share'+os.sep+'@PACKAGE@'+os.sep+'python')

import monet_options
import Mapi


def main(argv) :

    cmd_options = [
        ('host',None,'host','hostname','host to connect to (default: localhost)'),
        ('port',None,'mapi_port','port','port to connect to (default: 50000)'),
        ]

    try:
        opt, args = monet_options.parse_options(argv[1:], cmd_options)
    except monet_options.Error:
        # error parsing options
        sys.exit(1)

    s = Mapi.server( opt.get("host","localhost"), int(opt.get("mapi_port",50000)), "adm" )

    res = s.cmd_intern( "shutdown;\n" )
    s.disconnect()

### main(argv) #


if __name__ == "__main__":
    if '--trace' in sys.argv:
        sys.argv.remove('--trace')
        import trace
        t = trace.Trace(trace=1, count=0)
        t.runfunc(main, sys.argv)
    else:
        main(sys.argv)

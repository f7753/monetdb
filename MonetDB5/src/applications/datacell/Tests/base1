# assume pingpong is loaded with a single tuple in the receptor
# experiment with the effect of delays

#variants can be constructed using a larger receptor batch
(pub:bat[:void,:timestamp], priv:bat[:void,:timestamp]) := datacell.bindReceptor("ping","stamp");
(public:bat[:void,:int], private:bat[:void,:int]) := datacell.bindReceptor("ping","event");

barrier (go,i):= mal.newRange(0:lng);
	z := mtime.current_timestamp();
	bat.insert(priv,nil,z);
	zi:= calc.int(i);
	bat.insert(private,nil,zi);
	redo (go,i):= mal.nextElement(1:lng,999:lng);
exit (go,i);

io.print(private);

datacell.startPump("bat");

datacell.startScheduler(100,0);
alarm.sleep(2); 

datacell.startScheduler(100,100);
alarm.sleep(12); 

datacell.startScheduler(100,500);
alarm.sleep(70); 

datacell.startScheduler(100,1000);
alarm.sleep(150); 

datacell.startScheduler(100,1500);
alarm.sleep(200); 

datacell.startScheduler(100,2000);
alarm.sleep(250); 


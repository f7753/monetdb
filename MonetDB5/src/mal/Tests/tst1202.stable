# Monet Database Server V5.0
# Copyright (c) 1993-2003, CWI. All rights reserved.
# compiled for 32biti686-pc-linux-gnu/32bit.
# config:/ufs/mk/monet_5/src/mal/Tests/tst.conf
# dbfarm:/ufs/mk/monet_5/Linux/var/MonetDB
# dbname:demo
##       rule_jan:= rule("1st MON from start of JAN@01:15");
##	rule_mar:= rule("first WEDNE on or after march 10@01:15");
#        rule_apr:= rule("last THU on or before aPr 1@01:15");
##        rule_may:= rule("MAY 26@01:15");
##        rule_jun:= rule("2nd TUE from end of june@01:15");
##        rule_jul:= rule(7,1,1,75);
##        rule_aug:= rule(8,-1,1,75);
##        rule_sep:= rule(9,-10,3,75);
##        rule_oct:= rule(10,31,0,75);
#        rule_nov:= rule(11,-10,-4,75);
##        rule_dec:= rule(12,-31,0,75);
##        rule_feb:= rule("first fRiDaY on or after february 30@01:15");
#
#
##	tzone_00:= tzone("GMT");
##	tzone_01:= tzone("GMT+01:00");
##	tzone_02:= tzone("GMT+0100");
##	tzone_03:= tzone(60,rule_oct,rule_mar);
##	tzone_04:= tzone(0,rule_jan,rule_aug);
##	tzone_05:= tzone(-97,rule_oct,rule_apr);
##	tzone_06:= tzone(-97,rule_may,rule_sep);
#print("start");
#	mc_a := *(23,60);
#	tzone_07:= tzone(mc_a,rule_apr,rule_nov);
#	nc_a := *(-23,59);
#	oc_a := -(nc_a,59);
#	tzone_08:= tzone(oc_a);
##print("tzone_08");
##print(tzone_08);
#	tzone_09:= tzone(0);
##print("tzone_09");
##print(tzone_09);
##	tzone_10:= tzone(-60);
##print("tzone_10");
##print(tzone_10);
#	pc_a := *(23,60);
#	qc_a := +(pc_a,59);
##	tzone_11:= tzone(qc_a);
##	tzone_12:= tzone(60);
##	tzone_13:= tzone(60,rule_feb,rule_dec);
##	rc_a := *(24,60);
##	tzone_15:= tzone(rc_a,rule_apr,rule_nov);
#	tzone_bat:= new(:oid,:tzone);
##	sc_a := insert(tzone_bat,00@0,tzone_00);
##	tc_a := insert(sc_a,01@0,tzone_01);
##	uc_a := insert(tc_a,02@0,tzone_02);
##	vc_a := insert(tzone_bat,03@0,tzone_03);
##	wc_a := insert(vc_a,04@0,tzone_04);
##	xc_a := insert(wc_a,05@0,tzone_05);
##	yc_a := insert(tzone_bat,06@0,tzone_06);
##	ad_a := insert(yc_a,07@0,tzone_07);
#	bd_a := insert(tzone_bat,08@0,tzone_08);
#	cd_a := insert(tzone_bat,09@0,tzone_09);
##	dd_a := insert(cd_a,10@0,tzone_10);
##	ed_a := insert(dd_a,11@0,tzone_11);
##	fd_a := insert(tzone_bat,12@0,tzone_12);
##	gd_a := insert(fd_a,13@0,tzone_13);
##	hd_a := insert(gd_a,15@0,tzone_15);
#	id_a := setColumn(tzone_bat,"tzone");
#	jd_a := print(id_a);
##print("tzone"); print(jd_a);
##	kd_a := multiplex.script("minutes",tzone_bat);
##	ld_a := setColumn(kd_a,"minutes");
##print("minutes"); print(ld_a);
##	md_a := multiplex.script("start_dst",tzone_bat);
##	nd_a := setColumn(md_a,"start_dst");
##print("start_dst"); print(nd_a);
##	od_a := multiplex.script("end_dst",tzone_bat);
##	pd_a := setColumn(od_a,"end_dst");
##print("end_dst");print(pd_a);
##	qd_a := print(ld_a,nd_a,pd_a);
#
function Admin.main():int;	# 0  (main:int)
    rule_apr := mtime.rule("last THU on or before aPr 1@01:15");	# 1 rule_create_fromstr (rule_apr:rule)<-($2:str)
    rule_nov := mtime.rule(11,-10,-4,75);	# 2 rule_create (rule_nov:rule)<-($4:int)($5:int)($6:int)($7:int)
    io.print("start");	# 3 CMDprint_val ($8:int)<-($9:str)
    mc_a := calc.*(23,60);	# 4 CALCbinaryMULintint (mc_a:int)<-($11:int)($12:int)
    tzone_07 := mtime.tzone(mc_a,rule_apr,rule_nov);	# 5 tzone_create_dst (tzone_07:tzone)<-(mc_a:int)(rule_apr:rule)(rule_nov:rule)
    nc_a := calc.*(-23,59);	# 6 CALCbinaryMULintint (nc_a:int)<-($15:int)($16:int)
    oc_a := calc.-(nc_a,59);	# 7 CALCbinarySUBintint (oc_a:int)<-(nc_a:int)($16:int)
    tzone_08 := mtime.tzone(oc_a);	# 8 tzone_create (tzone_08:tzone)<-(oc_a:int)
    tzone_09 := mtime.tzone(0);	# 9 tzone_create (tzone_09:tzone)<-($20:int)
    pc_a := calc.*(23,60);	# 10 CALCbinaryMULintint (pc_a:int)<-($11:int)($12:int)
    qc_a := calc.+(pc_a,59);	# 11 CALCbinaryADDintint (qc_a:int)<-(pc_a:int)($16:int)
    tzone_bat := bbp.new(:oid,:tzone);	# 12 CMDBATnew (tzone_bat:bat[oid,tzone])<-($24:oid)($25:tzone)
    bd_a := bat.insert(tzone_bat,08@0,tzone_08);	# 13 CMDinsert_bun (bd_a:void)<-(tzone_bat:bat[oid,tzone])($27:oid)(tzone_08:tzone)
    cd_a := bat.insert(tzone_bat,09@0,tzone_09);	# 14 CMDinsert_bun (cd_a:void)<-(tzone_bat:bat[oid,tzone])($29:oid)(tzone_09:tzone)
    id_a := bat.setColumn(tzone_bat,"tzone");	# 15 CMDsetColumn (id_a:bat[oid,tzone])<-(tzone_bat:bat[oid,tzone])($31:str)
    jd_a := io.print(id_a);	# 16 CMDprint_val (jd_a:int)<-(id_a:bat[oid,tzone])
end main;	# 17  
[ "start" ]
#-------------------------#
# BAT:	  tmp_4		  #
# (oid)	  (tzone)	  #
#-------------------------#
[ 8@0,	  GMT-23:36	  ]
[ 9@0,	  GMT		  ]
>
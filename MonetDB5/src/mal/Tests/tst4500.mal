# Beware this is not the correct TPC-1, but a merely a test
include sql;
setDebug();
CXoptimizer();
ARoptimizer();
DCoptimizer();
quit();
include sql;
#s14 := sql.bind("sys",  "lineitem", "l_shipdate"); #lineitem
	myc:= bbp.bind("myc");
	s14:bat[:void,:date] := sql.bind("sys","lineitem","l_shipdate",0);
#s16 := date("1998-12-01");
	s16 := date("1998-12-01");
#s17 := 7776000;
	s17 := 7776000;
#s15 := date_sub_sec_interval(s16,s17);
#s13 := s14.uselect(date(nil), s15);
	zz:= nil:str;
	aa_a := date(zz);
	s13 := uselect(s14,aa_a,aa_a);
#s12 := s13.reverse();
	s12 := reverse(s13,);
#s11 := s12.reverse().mark(oid(0)).reverse();# lineitem
	ba_a := oid(0);
	ca_a := reverse(s12,);
	da_a := markTail(ca_a,ba_a);
	s11 := reverse(da_a,);
#s18 := sql.bind("sys",  "lineitem", "l_returnflag"); #lineitem
	s18:bat[:void,:chr] := sql.bind("sys","lineitem","l_returnflag",0);
#s10 := s11.join(s18);
	s10 := join(s11,s18);
#s9 := s10.group();
	s9 := group(s10,);
#s20 := sql.bind("sys",  "lineitem", "l_linestatus"); #lineitem
	s20:bat[:void,:chr] := sql.bind("sys","lineitem","l_linestatus",0);
#s19 := s11.join(s20);
	s19 := join(s11,s20);
#s8 := s9.group(s19);
	s8 := group(s9,s19);
#s7 := s8.tunique().mirror();
	ea_a := tunique(s8,);
	s7 := mirror(ea_a,);
#s6 := s7.join(s11);
	s6 := join(s7,s11);
#s5 := s6.join(s18);
	s5 := join(s6,s18);
#s4 := s5.reverse().sort().reverse();
	fa_a := reverse(s5,);
	ga_a := sort(fa_a,);
	s4 := reverse(ga_a,);
#s22 := s7.join(s11);
	s22 := join(s7,s11);
#s21 := s22.join(s20);
	s21 := join(s22,s20);
#s3 := s4.CTrefine(s21);
	s3 := refine(s4,s21);
#s25 := s11.join(s18);
	s25 := join(s11,s18);
#s24 := s7.join(s25);
	s24 := join(s7,s25);
#s27 := s11.join(s20);
	s27 := join(s11,s20);
#s26 := s7.join(s27);
	s26 := join(s7,s27);
#s31 := sql.bind("sys",  "lineitem", "l_quantity"); #lineitem
	s31:bat[:void,:int] := sql.bind("sys","lineitem","l_quantity",0);
#s30 := s11.join(s31);
	s30 := join(s11,s31);
#s29 := {sum}(s30, s8, s7);
	s29 := group.sum(s30,s8);
#s35 := sql.bind("sys",  "lineitem", "l_extendedprice"); #lineitem
	s35:bat[:void,:int] := sql.bind("sys","lineitem","l_extendedprice",0);
#s34 := s11.join(s35);
	s34 := join(s11,s35);
#s33 := {sum}(s34, s8, s7);
	s33 := group.sum(s34,s8);
#s39 := s11.join(s35);
	s39 := join(s11,s35);
#s42 := 1;
	s42 := 1;
#s41 := flt(s42);
	s41 := flt(s42);
#s44 := sql.bind("sys",  "lineitem", "l_discount"); #lineitem
	s44:bat[:void,:int] := sql.bind("sys","lineitem","l_discount",0);
#s43 := s11.join(s44);
	s43 := join(s11,s44);
#s45 := [s43 ~ s41];
	ha_a:= zipper(s43,s41);
	s45 := ha_a;
#s40 := [-](s45,s43);
	s40 := multiplex.tactics("-",s45,s43);
#s38 := [*](s39,s40);
	s38 := multiplex.tactics("*",s39,s40);
#s37 := {sum}(s38, s8, s7);
	s37 := group.sum(s38,s8);
#s50 := s11.join(s35);
	s50 := join(s11,s35);
#s53 := 1;
	s53 := 1;
#s52 := flt(s53);
	s52 := flt(s53);
#s54 := s11.join(s44);
	s54 := join(s11,s44);
#s55 := [s54 ~ s52];
	ia_a:= zipper(s54,s52);
	s55 := ia_a;
#s51 := [-](s55,s54);
	s51 := multiplex.tactics("-",s55,s54);
#s49 := [*](s50,s51);
	s49 := multiplex.tactics("*",s50,s51);
#s58 := 1;
	s58 := 1;
#s57 := flt(s58);
	s57 := flt(s58);
#s60 := sql.bind("sys",  "lineitem", "l_tax"); #lineitem
	s60:bat[:void,:int] := sql.bind("sys","lineitem","l_tax",0);
#s59 := s11.join(s60);
	s59 := join(s11,s60);
#s61 := [s59 ~ s57];
	ja_a:= zipper(s59,s57);
	s61 := ja_a;
#s56 := [+](s61,s59);
	s56 := multiplex.tactics("+",s61,s59);
#s48 := [*](s49,s56);
	s48 := multiplex.tactics("*",s49,s56);
#s47 := {sum}(s48, s8, s7);
	s47 := group.sum(s48,s8);
#s64 := s11.join(s31);
	s64 := join(s11,s31);
#s63 := {avg}(s64, s8, s7);
	s63 := group.avg(s64,s8);
#s67 := s11.join(s35);
	s67 := join(s11,s35);
#s66 := {avg}(s67, s8, s7);
	s66 := group.avg(s67,s8);
#s70 := s11.join(s44);
	s70 := join(s11,s44);
#s69 := {avg}(s70, s8, s7);
	s69 := group.avg(s70,s8);
#s72 := {count}(s8, s8, s7);
#	s72 := group.count(s8,s8);
print(s64,s67,s66,s70,s69);

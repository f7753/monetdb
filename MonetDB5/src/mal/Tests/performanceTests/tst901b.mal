# what is the overhead of MAL in multiplex situations
# using a BATloop !! This is 40x slower as the V4.3 multiplex implementation
#profiler.setAll();
#profiler.setLogFile("/tmp/MonetProfile.xml");
b:= new(:lng,:lng);
t0:= alarm.usec();
barrier (v,i):= newRange(0:lng);
	insert(b,i,i);
	redo (v,i):= nextElement(1:lng,1000000:lng);
exit (v,i);
t1:= alarm.usec();
c:=copy(b);
t2:= alarm.usec();
d:= new(:lng,:lng);
barrier (mloop,h,t):= newIterator(b);
        zz:= find(b,h);
        z:= find(c,h);
	cr:= zz+z;
	insert(d,h,cr);
catch GDKerror;
	leave mloop;
exit GDKerror;
	redo (mloop,h,t):= hasMoreElements(b);
exit (mloop,h,t);
t3:= alarm.usec();
#CMD000(b,b);
t4:= alarm.usec();
d1:= t1-t0;
d2:= t3-t2;
d3:= t4-t3;
cnt:= count(d);
printf("cnt %d ",cnt);
printf("make %d ",d1);
printf("multiplex %d\n",d2);
printf("compiled multiplex %d\n",d3);
#profiler.stop();

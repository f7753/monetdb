# what is the overhead of MAL in multiplex situations
# using a BATloop !! This is 40x slower as the V4.3 multiplex implementation
#profiler.setAll();
#profiler.setLogFile("/tmp/MonetProfile.xml");
b:= new(:lng,:lng,1000100);
t0:= alarm.usec();
i:= -1:lng;
t0:= alarm.usec();
barrier v:= nextElement(i,0:lng,1000000:lng);
	insert(b,i,i);
	redo v;
exit v;
t1:= alarm.usec();
c:=copy(b);
t2:= alarm.usec();
d:= new(:lng,:lng,1000100);
h:= 0:lng;
t:= 0:lng;
barrier mloop:= bunStream(b,h,t);
	B2:= find(b,h);
	B3:= find(c,h);
	cr:= B2+B3;
	insert(d,h,cr);
catch GDKerror;
	leave mloop;
exit GDKerror;
	redo mloop;
exit mloop;
t3:= alarm.usec();
#CMD000(b,b);
t4:= alarm.usec();
d1:= t1-t0;
d2:= t3-t2;
d3:= t4-t3;
cnt:= count(d);
printf("cnt %d ",cnt);
printf("make %d ",d1);
printf("multiplex %d\n",d2);
printf("compiled multiplex %d\n",d3);
#profiler.stop();

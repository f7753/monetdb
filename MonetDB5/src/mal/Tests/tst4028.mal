# testing the heuristic rules
# relations r(H,T) and s(H,T)
function qry();
r:= new(:int,:int);
insert(r,5,1);
insert(r,6,2);
insert(r,7,3);
insert(r,8,4);
sc:= copy(r);
s:= reverse(sc);

print(r);
print(s);

# reversal analysis
# r.T=s.H and r.T<6 (SQL output)
t:= join(r,s);
tr:= semijoin(r,t);
z:= select(tr,0,6);
tz:= semijoin(t,z);
print(tz);

# optimized sequence
ab:= select(r,0,6);
bc:= join(ab,s);
setDebug();
SPoptimizer();
end qry;

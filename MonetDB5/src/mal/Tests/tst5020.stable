# Monet Database Server V5.0
# Copyright (c) 1993-2004, CWI. All rights reserved.
# compiled for 32biti686-pc-linux-gnu/32bit.
# config:/ufs/mk/monet5/src/mal/Tests/tst.conf
# dbfarm:/ufs/mk/monet5/Linux/var/MonetDB/dbfarm
# dbname:demo
# Visit http://monetdb.cwi.nl for further information.
## determine basic costs for cracking a larger table.
#b:= new(:int,:int);
#i:= -1:int;
#barrier v:= nextElement(i,0:int,1000000:int);
#        k:= rand();
#        l:= int(k);
#        insert(b,l,l);
#        redo v:= nextElement(i,0:int,1000000:int);
#exit v;
##setReadMode(b);
#mx:= max(b);
#printf("max %d",mx);
#mi:= min(b);
#printf(" min %d\n",mi);
#t0:= alarm.usec();
#c:= copy(b);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#copy %d\n",d0);
#
#t0:= alarm.usec();
#(cidx,vrng):= crackers.new(b);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#crack init %d\n",d0);
##print(vrng);
#
#l:= mi*2;
#h:= mx/2;
##printf("select %d ",l);
##printf("%d\n",h);
#t0:= alarm.usec();
#z:= crackers.crack(b,cidx,vrng,l,h);
#t1:= alarm.usec();
##print(vrng);
#d0:= t1-t0;
#printf("#crack %d\n",d0);
#
#l:= l*2;
#h:= h/2;
##printf("select %d ",l);
##printf("%d\n",h);
#t0:= alarm.usec();
#y:= crackers.crack(b,cidx,vrng,l,h);
##print(vrng);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#crack %d\n",d0);
#
#l:= l*2;
#h:= h/2;
##printf("select %d ",l);
##printf("%d\n",h);
#t0:= alarm.usec();
#y:= crackers.crack(b,cidx,vrng,l,h);
##print(vrng);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#crack %d\n",d0);
#
#l:= l*2;
#h:= h/2;
##printf("select %d ",l);
##printf("%d\n",h);
#t0:= alarm.usec();
#y:= crackers.crack(b,cidx,vrng,l,h);
##print(vrng);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#crack %d\n",d0);
#print(cidx);
#print(vrng);
#
## Compare cracker with ordinary selection
#t0:= alarm.usec();
#i:= max(b);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#max %d\n",d0);
#t0:= alarm.usec();
#i:= min(b);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#min %d\n",d0);
#
#l:= mi*2;
#h:= mx/2;
##printf("select %d ",l);
##printf("%d\n",h);
#t0:= alarm.usec();
#c:= select(b,l,h);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#select %d\n",d0);
#
#l:= l*2;
#h:= h/2;
##printf("select %d ",l);
##printf("%d\n",h);
#t0:= alarm.usec();
#c:= select(b,l,h);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#select %d\n",d0);
#
#l:= l*2;
#h:= h/2;
##printf("select %d ",l);
##printf("%d\n",h);
#t0:= alarm.usec();
#c:= select(b,l,h);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#select %d\n",d0);
#
#l:= l*2;
#h:= h/2;
##printf("select %d ",l);
##printf("%d\n",h);
#t0:= alarm.usec();
#c:= select(b,l,h);
#t1:= alarm.usec();
#d0:= t1-t0;
#printf("#select %d\n",d0);
#
function Admin.main():int;	# 0  (main:int)
    b := bbp.new(:int,:int);	# 1 CMDBATnew (b:bat[:int,:int])<-($2:int)($3:int)
    i := -1;	# 2  (i:int)<-($5:int)
barrier v := mal.nextElement(i,0,1000000);	# 3 intForloop (v:bit)<-(i:int)($7:int)($8:int) jump 8
    k := calc.rand();	# 4 CALCrandint (k:int)
    l := calc.int(k);	# 5 CALCint2int (l:int)<-(k:int)
    bat.insert(b,l,l);	# 6 BKCinsert_bun ($11:void)<-(b:bat[:int,:int])(l:int)(l:int)
    redo v := mal.nextElement(i,0,1000000);	# 7 intForloop (v:bit)<-(i:int)($7:int)($8:int) jump 4
exit v;	# 8  (v:bit)
    mx := algebra.max(b);	# 9 ALGmax_int (mx:int)<-(b:bat[:int,:int])
    io.printf("max %d",mx);	# 10 IOprint_formatted_int ($13:int)<-($14:str)(mx:int)
    mi := algebra.min(b);	# 11 ALGmin_int (mi:int)<-(b:bat[:int,:int])
    io.printf(" min %d\n",mi);	# 12 IOprint_formatted_int ($16:int)<-($17:str)(mi:int)
    t0 := alarm.usec();	# 13 ALARMusec (t0:lng)
    c := algebra.copy(b);	# 14 ALGcopy (c:bat[:int,:int])<-(b:bat[:int,:int])
    t1 := alarm.usec();	# 15 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 16 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#copy %d\n",d0);	# 17 IOprint_formatted_lng ($22:int)<-($23:str)(d0:lng)
    t0 := alarm.usec();	# 18 ALARMusec (t0:lng)
    (cidx,vrng):= crackers.new(b);	# 19 CRKnew (cidx:bat[:int,:int])(vrng:bat[:int,:int])<-(b:bat[:int,:int])
    t1 := alarm.usec();	# 20 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 21 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#crack init %d\n",d0);	# 22 IOprint_formatted_lng ($26:int)<-($27:str)(d0:lng)
    l := calc.*(mi,2);	# 23 CALCbinaryMULintint (l:int)<-(mi:int)($28:int)
    h := calc./(mx,2);	# 24 CALCbinarycheckDIVintint (h:int)<-(mx:int)($28:int)
    t0 := alarm.usec();	# 25 ALARMusec (t0:lng)
    z := crackers.crack(b,cidx,vrng,l,h);	# 26 CRKcrackNaive (z:int)<-(b:bat[:int,:int])(cidx:bat[:int,:int])(vrng:bat[:int,:int])(l:int)(h:int)
    t1 := alarm.usec();	# 27 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 28 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#crack %d\n",d0);	# 29 IOprint_formatted_lng ($31:int)<-($32:str)(d0:lng)
    l := calc.*(l,2);	# 30 CALCbinaryMULintint (l:int)<-(l:int)($28:int)
    h := calc./(h,2);	# 31 CALCbinarycheckDIVintint (h:int)<-(h:int)($28:int)
    t0 := alarm.usec();	# 32 ALARMusec (t0:lng)
    y := crackers.crack(b,cidx,vrng,l,h);	# 33 CRKcrackNaive (y:int)<-(b:bat[:int,:int])(cidx:bat[:int,:int])(vrng:bat[:int,:int])(l:int)(h:int)
    t1 := alarm.usec();	# 34 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 35 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#crack %d\n",d0);	# 36 IOprint_formatted_lng ($34:int)<-($32:str)(d0:lng)
    l := calc.*(l,2);	# 37 CALCbinaryMULintint (l:int)<-(l:int)($28:int)
    h := calc./(h,2);	# 38 CALCbinarycheckDIVintint (h:int)<-(h:int)($28:int)
    t0 := alarm.usec();	# 39 ALARMusec (t0:lng)
    y := crackers.crack(b,cidx,vrng,l,h);	# 40 CRKcrackNaive (y:int)<-(b:bat[:int,:int])(cidx:bat[:int,:int])(vrng:bat[:int,:int])(l:int)(h:int)
    t1 := alarm.usec();	# 41 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 42 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#crack %d\n",d0);	# 43 IOprint_formatted_lng ($35:int)<-($32:str)(d0:lng)
    l := calc.*(l,2);	# 44 CALCbinaryMULintint (l:int)<-(l:int)($28:int)
    h := calc./(h,2);	# 45 CALCbinarycheckDIVintint (h:int)<-(h:int)($28:int)
    t0 := alarm.usec();	# 46 ALARMusec (t0:lng)
    y := crackers.crack(b,cidx,vrng,l,h);	# 47 CRKcrackNaive (y:int)<-(b:bat[:int,:int])(cidx:bat[:int,:int])(vrng:bat[:int,:int])(l:int)(h:int)
    t1 := alarm.usec();	# 48 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 49 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#crack %d\n",d0);	# 50 IOprint_formatted_lng ($36:int)<-($32:str)(d0:lng)
    io.print(cidx);	# 51 IOprint_val ($37:int)<-(cidx:bat[:int,:int])
    io.print(vrng);	# 52 IOprint_val ($38:int)<-(vrng:bat[:int,:int])
    t0 := alarm.usec();	# 53 ALARMusec (t0:lng)
    i := algebra.max(b);	# 54 ALGmax_int (i:int)<-(b:bat[:int,:int])
    t1 := alarm.usec();	# 55 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 56 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#max %d\n",d0);	# 57 IOprint_formatted_lng ($39:int)<-($40:str)(d0:lng)
    t0 := alarm.usec();	# 58 ALARMusec (t0:lng)
    i := algebra.min(b);	# 59 ALGmin_int (i:int)<-(b:bat[:int,:int])
    t1 := alarm.usec();	# 60 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 61 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#min %d\n",d0);	# 62 IOprint_formatted_lng ($41:int)<-($42:str)(d0:lng)
    l := calc.*(mi,2);	# 63 CALCbinaryMULintint (l:int)<-(mi:int)($28:int)
    h := calc./(mx,2);	# 64 CALCbinarycheckDIVintint (h:int)<-(mx:int)($28:int)
    t0 := alarm.usec();	# 65 ALARMusec (t0:lng)
    c := algebra.select(b,l,h);	# 66 ALGselect (c:bat[:int,:int])<-(b:bat[:int,:int])(l:int)(h:int)
    t1 := alarm.usec();	# 67 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 68 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#select %d\n",d0);	# 69 IOprint_formatted_lng ($43:int)<-($44:str)(d0:lng)
    l := calc.*(l,2);	# 70 CALCbinaryMULintint (l:int)<-(l:int)($28:int)
    h := calc./(h,2);	# 71 CALCbinarycheckDIVintint (h:int)<-(h:int)($28:int)
    t0 := alarm.usec();	# 72 ALARMusec (t0:lng)
    c := algebra.select(b,l,h);	# 73 ALGselect (c:bat[:int,:int])<-(b:bat[:int,:int])(l:int)(h:int)
    t1 := alarm.usec();	# 74 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 75 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#select %d\n",d0);	# 76 IOprint_formatted_lng ($45:int)<-($44:str)(d0:lng)
    l := calc.*(l,2);	# 77 CALCbinaryMULintint (l:int)<-(l:int)($28:int)
    h := calc./(h,2);	# 78 CALCbinarycheckDIVintint (h:int)<-(h:int)($28:int)
    t0 := alarm.usec();	# 79 ALARMusec (t0:lng)
    c := algebra.select(b,l,h);	# 80 ALGselect (c:bat[:int,:int])<-(b:bat[:int,:int])(l:int)(h:int)
    t1 := alarm.usec();	# 81 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 82 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#select %d\n",d0);	# 83 IOprint_formatted_lng ($46:int)<-($44:str)(d0:lng)
    l := calc.*(l,2);	# 84 CALCbinaryMULintint (l:int)<-(l:int)($28:int)
    h := calc./(h,2);	# 85 CALCbinarycheckDIVintint (h:int)<-(h:int)($28:int)
    t0 := alarm.usec();	# 86 ALARMusec (t0:lng)
    c := algebra.select(b,l,h);	# 87 ALGselect (c:bat[:int,:int])<-(b:bat[:int,:int])(l:int)(h:int)
    t1 := alarm.usec();	# 88 ALARMusec (t1:lng)
    d0 := calc.-(t1,t0);	# 89 CALCbinarySUBlnglng (d0:lng)<-(t1:lng)(t0:lng)
    io.printf("#select %d\n",d0);	# 90 IOprint_formatted_lng ($47:int)<-($44:str)(d0:lng)
end main;	# 91  
max 2147480021 min 1210
#copy 22
#crack init 35664
#crack 49368
#crack 24477
#crack 12147
#crack 5902
#-------------------------#
# h	tmp_5		  # name
# int	int		  # type
#-------------------------#
[ 1,	  1		  ]
[ 2,	  3		  ]
[ 499990, 1000000	  ]
[ 4,	  6		  ]
[ 249960, 499989	  ]
[ 7,	  10		  ]
[ 124816, 249959	  ]
[ 11,	  62435		  ]
[ 62436,  124815	  ]
#---------------------------------#
# h		tmp_6		  # name
# int		int		  # type
#---------------------------------#
[ 1210,		  2419		  ]
[ 2420,		  4839		  ]
[ 1073740011,	  2147480021	  ]
[ 4840,		  9679		  ]
[ 536870006,	  1073740010	  ]
[ 9680,		  19359		  ]
[ 268435003,	  536870005	  ]
[ 19360,	  134217501	  ]
[ 134217502,	  268435002	  ]
#max 19286
#min 18480
#select 33707
#select 27530
#select 24851
#select 23496
>
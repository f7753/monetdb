#testing the partition optimizer

a1:= new(:void,:int);
setSequenceBase(a1,0@0);
a2:= new(:void,:int);
setSequenceBase(a2,10@0);
a3:= new(:void,:int);
setSequenceBase(a3,20@0);

barrier (go,i):= newRange(0);
	insert(a1,nil,i);
	insert(a2,nil,i);
	insert(a3,nil,i);
	redo (go,i):= nextElement(1,10);
exit (go,i);
#print(a1);
#print(a2);
#print(a3);


# add it to the BAT partition table
partitions.deposit(a1);
partitions.deposit(a1,a2);
partitions.deposit(a1,a3);
partitions.dump();

function qry(a:bat[:void,:any]);
	print("hello");
	print(a);
end qry;

optimizer.partitionedQuery("Admin","qry");
showFunction("Admin","qry");
print("run experiment");
qry(a1);

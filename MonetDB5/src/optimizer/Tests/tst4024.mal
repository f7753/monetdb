# testing the heuristic rules
# relations r(H,T) and s(H,T)
function qry();
r:= bbp.new(:int,:int);
bat.insert(r,5:int,1:int);
bat.insert(r,6:int,2:int);
bat.insert(r,7:int,3:int);
bat.insert(r,8:int,4:int);
sc:= algebra.copy(r);
s:= bat.reverse(sc);

io.print(r);
io.print(s);

# traditional push select through join
# r.T=s.H and s.T<6
t:= algebra.join(r,s);
z:= algebra.select(t,0:int,6:int);
io.print(z);

# alternative instruction
# s.H=r.H and s.T<2
a:= algebra.semijoin(s,r);
z:= algebra.select(a,0:int,2:int);
io.print(z);
optimizer.setDebug();
optimizer.selectPushdown();
end qry;

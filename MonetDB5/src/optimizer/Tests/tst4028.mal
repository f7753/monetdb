# testing the heuristic rules
# relations r(H,T) and s(H,T)
function qry();
	r:= bbp.new(:int,:int);
	bat.insert(r,5,1);
	bat.insert(r,6,2);
	bat.insert(r,7,3);
	bat.insert(r,8,4);
	sc:= algebra.copy(r);
	s:= bat.reverse(sc);

	io.print(r);
	io.print(s);

	# reversal analysis
	# r.T=s.H and r.T<6 (SQL output)
	t:= algebra.join(r,s);
	tr:= algebra.semijoin(r,t);
	z:= algebra.select(tr,0,6);
	tz:= algebra.semijoin(t,z);
	io.print(tz);

	# optimized sequence
	ab:= algebra.select(r,0,6);
	bc:= algebra.join(ab,s);
	optimizer.setDebug();
	optimizer.selectPushdown(); 
end qry;

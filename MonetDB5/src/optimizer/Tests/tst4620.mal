#some join operations
function algebra.joinPath( a:bat[:any$1,:any$2],
                b:bat[:any$2,:any$3],
                c:bat[:any$3,:any$4]):bat[:any$1,:any$4];
    z:= algebra.join(a,b);
    zz:= algebra.join(z,c);
    return zz;
end joinPath;

b:= bbp.new(:int,:int);
barrier (k,v):= mal.newRange(0:int);
        bat.insert(b,v,v);
        redo (k,v):= mal.nextElement(1:int,100:int);
exit (k,v);

i:= algebra.count(b);
io.print(i);

c:= algebra.select(b,0:int,9:int);
i:= algebra.count(c);
io.print(i);
d:= algebra.select(b,0:int,49:int);
i:= algebra.count(d);
io.print(i);

optimizer.macroContraction("algebra","joinPath");
#to be detected by join inversion
z:= algebra.join(b,c);
zz:= algebra.join(z,d);
i:= algebra.count(zz);
io.print(i);
mdb.showFunction();
